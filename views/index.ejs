<%- include("partials/header.ejs") %>


<body>
  <div class="container">
    <div>
      <!-- <h1>✏️📋 To Do List App 📋✏️</h1> -->
      <h1>📋 To Do List App 📋</h1>
    </div>

    <% if (locals.tasks && locals.listName) { %>

    <h2> You have <%= locals.tasks.length %> items in your <%= locals.listName %> task list.</h2>

    <!-- List of tasks. -->
    <div class="taskDiv">
      <% for ( i=0; i < locals.tasks.length; i++ ) { %>
      <div class="task">
        <!-- Make each row a form so that we can action the checkbox -->
        <form action="/done/<%= locals.listName %>/<%= locals.tasks[i]._id %>" method="post">
          <input type="checkbox" name="done" onChange="this.form.submit()" <% if (locals.tasks[i].done) { %> checked <% } %>>
          <p><%= locals.tasks[i].text %></p>
        </form>
      </div>
      <% } %>
    </div>

    <!-- Prune completed tasks. -->
    <div class="pruneDiv">
      <div>
        <form action="/prune" method="post">
          <button type="submit" name="listName" value="<%= locals.listName %>" list=""> 🗑️ Prune completed tasks 🗑️ </button>
        </form>
      </div>
    </div>

    <!-- Add new task item. -->
    <div class="newTaskDiv">
      <form class="item" action="/" method="post">
        <input type="text" name="newItem" placeholder="Add a new task here" autocomplete="off">
        <button type="submit" name="listName" value="<%= locals.listName %>" list=""> add task </button>
      </form>
    </div>

    <% } %>
  </div>
</body>


<%- include("partials/footer.ejs") %>

</html>